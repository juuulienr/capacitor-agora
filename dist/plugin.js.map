{"version":3,"file":"plugin.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\nconst Agora = registerPlugin('Agora', {\n    web: () => import('./web').then((m) => new m.AgoraWeb()),\n});\nexport * from './definitions';\nexport { Agora };\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\nexport class AgoraWeb extends WebPlugin {\n    constructor() {\n        super(...arguments);\n        this.appId = null;\n    }\n    async initialize(options) {\n        console.log('[AgoraWeb] initialize called with options:', options);\n        const AgoraRTC = window.AgoraRTC;\n        if (!AgoraRTC) {\n            throw new Error('[AgoraWeb] AgoraRTC is not available. Ensure you included the AgoraRTC script.');\n        }\n        if (!options.appId) {\n            throw new Error('App ID is required');\n        }\n        this.appId = options.appId;\n        // Création d'un client Agora avec la configuration recommandée\n        this.client = AgoraRTC.createClient({ mode: 'live', codec: 'vp8' });\n        console.log('[AgoraWeb] AgoraRTC client created');\n    }\n    async setupLocalVideo() {\n        console.log('[AgoraWeb] setupLocalVideo called');\n        const AgoraRTC = window.AgoraRTC;\n        if (!AgoraRTC) {\n            throw new Error('[AgoraWeb] AgoraRTC is not available.');\n        }\n        try {\n            const livestreamContainer = document.querySelector('.livestream');\n            if (!livestreamContainer) {\n                throw new Error('[AgoraWeb] No element found with class \"livestream\". Ensure it exists in the DOM.');\n            }\n            // Création des pistes vidéo et audio locales avec résolution maximale\n            this.localVideoTrack = await AgoraRTC.createCameraVideoTrack({\n                encoderConfig: '1080p'\n            });\n            this.localAudioTrack = await AgoraRTC.createMicrophoneAudioTrack();\n            console.log('[AgoraWeb] Local video and audio tracks created with high resolution');\n            const videoContainer = document.createElement('div');\n            videoContainer.id = 'local-video';\n            videoContainer.style.width = '100%';\n            videoContainer.style.height = '100%';\n            livestreamContainer.appendChild(videoContainer);\n            console.log('[AgoraWeb] Video container added to .livestream');\n            this.localVideoTrack.play('local-video');\n            console.log('[AgoraWeb] Local video track started');\n        }\n        catch (error) {\n            console.error('[AgoraWeb] Error in setupLocalVideo:', error);\n            throw error;\n        }\n    }\n    async joinChannel(options) {\n        console.log('[AgoraWeb] joinChannel called with options:', options);\n        if (!this.client) {\n            console.error('[AgoraWeb] Client is not initialized. Call initialize() first.');\n            throw new Error('Client is not initialized. Call initialize() first.');\n        }\n        if (!this.appId) {\n            console.error('[AgoraWeb] App ID is not initialized. Call initialize() first.');\n            throw new Error('App ID is not initialized. Call initialize() first.');\n        }\n        console.log('[AgoraWeb] Debugging joinChannel variables:');\n        console.log('App ID:', this.appId);\n        console.log('Channel Name:', options.channelName);\n        console.log('Token:', options.token);\n        console.log('UID:', options.uid);\n        await this.client.setClientRole('host');\n        console.log('[AgoraWeb] Client role set to host.');\n        try {\n            await this.client.join(this.appId, options.channelName, options.token, options.uid);\n            console.log('[AgoraWeb] Successfully joined channel:', options.channelName);\n            if (this.localAudioTrack && this.localVideoTrack) {\n                await this.client.publish([this.localAudioTrack, this.localVideoTrack]);\n                console.log('[AgoraWeb] Local audio and video tracks published');\n            }\n        }\n        catch (error) {\n            console.error('[AgoraWeb] Error while joining channel:', error);\n            throw error;\n        }\n    }\n    async switchCamera() {\n        console.log('[AgoraWeb] switchCamera called');\n        if (this.localVideoTrack && typeof this.localVideoTrack.switchDevice === 'function') {\n            const devices = await window.AgoraRTC.getCameras();\n            if (devices.length > 1) {\n                await this.localVideoTrack.switchDevice(devices[1].deviceId);\n                console.log('[AgoraWeb] Switched camera');\n            }\n            else {\n                console.warn('[AgoraWeb] No alternative camera available');\n            }\n        }\n        else {\n            console.error('[AgoraWeb] switchCamera is not supported or localVideoTrack is not initialized');\n        }\n    }\n    async leaveChannel() {\n        console.log('[AgoraWeb] leaveChannel called');\n        if (!this.client) {\n            throw new Error('[AgoraWeb] Client is not initialized.');\n        }\n        if (this.localVideoTrack) {\n            this.localVideoTrack.stop();\n            this.localVideoTrack.close();\n        }\n        if (this.localAudioTrack) {\n            this.localAudioTrack.stop();\n            this.localAudioTrack.close();\n        }\n        await this.client.leave();\n        console.log('[AgoraWeb] Left channel');\n    }\n    async enableWebViewTransparency() {\n        console.log('[AgoraWeb] enableWebViewTransparency called');\n        throw this.unimplemented('[AgoraWeb] enableWebViewTransparency is not implemented on the web.');\n    }\n    async disableWebViewTransparency() {\n        console.log('[AgoraWeb] disableWebViewTransparency called');\n        throw this.unimplemented('[AgoraWeb] disableWebViewTransparency is not implemented on the web.');\n    }\n}\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin"],"mappings":"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"}